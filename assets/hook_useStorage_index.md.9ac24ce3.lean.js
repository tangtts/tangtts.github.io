import{I as O,J as P,h as k,g as b,d as K,r as h,i as F,o as q,c as R,b as s,j as c,e as E,u as J,a as L,f as I}from"./app.09879e44.js";import{E as U}from"./chunks/index.49ff2811.js";function $(n={type:"localStorage",prefix:"",expire:1}){n=O(n)?P(n):n,n={...{type:"localStorage",prefix:"",expire:1},...n};const t=k([]);function D(a,l,p=0){if((l===""||l===null||l===void 0)&&(l=null),p&&(isNaN(p)||p<1))throw new Error("Expire must be a number");(p!=null?p:p=n.expire)*1e3;let A={value:l,time:Date.now(),expire:p};window[n.type].setItem(a,JSON.stringify(A));let d=t.value.findIndex(e=>e.key==a);d==-1?t.value.push({key:a,val:A}):t.value[d]={key:a,val:A}}function v(a){if(!window[n.type].getItem(a)||JSON.stringify(window[n.type].getItem(a))==="null")return null;const l=JSON.parse(window[n.type].getItem(a));let p=Date.now();return l.expire&&l.time+n.expire*1e3<p?(u(a),null):(D(a,l.value,l.expire),l.value)}const B=b(()=>{let a=window[n.type].length;t.value=[];for(let l=0;l<a;l++){let p=window[n.type].key(l);if(p){let A=window[n.type].getItem(p);try{t.value.push({key:p,val:JSON.parse(A)})}catch{}}}return t.value});function r(a){var p;return((p=n.prefix)!=null?p:"")+a}function u(a){window[n.type].removeItem(r(a)),t.value=t.value.filter(l=>l.key!==a)}function g(){window[n.type].clear(),t.value=[]}function _(a){return!!window[n.type].getItem(a)}function x(){return t.value.length||window[n.type].length}return{setStorage:D,getStorage:v,getAllStorage:B,autoAddPrefix:r,removeStorage:u,clearStorage:g,hasStorage:_,getStorageLength:x}}const j=K({__name:"index",setup(n){const i=k(),{getAllStorage:t,removeStorage:D,clearStorage:v,setStorage:B}=$(),r=h({key:"",value:"",expire:""}),u=h({key:[{required:!0,message:"Please input Key",trigger:"change"}],value:[{required:!0,message:"Please input Key",trigger:"change"}]});let g=[];const _=e=>{g=e},x=()=>{g.forEach(e=>{D(e.key)})},a=()=>{v()},l=e=>{D(e.key)};function p(e){return e.map(o=>({key:o.key,value:o.val.value,time:o.val.time,expire:o.val.expire}))}const A=b(()=>p(t.value)),d=async e=>{!e||await e.validate((o,f)=>{o?(U({message:"A success message.",type:"success"}),B(r.key,r.value,Number(r.expire)),e.resetFields()):console.log("error submit!",f)})};return(e,o)=>{const f=F("el-input"),m=F("el-form-item"),w=F("el-option"),V=F("el-select"),S=F("el-button"),N=F("el-form"),C=F("el-table-column"),T=F("el-table");return q(),R("div",null,[s(N,{inline:!0,ref_key:"ruleFormRef",ref:i,model:r,rules:u,class:"demo-form-inline"},{default:c(()=>[s(m,{label:"Storage Key",required:"",prop:"key"},{default:c(()=>[s(f,{modelValue:r.key,"onUpdate:modelValue":o[0]||(o[0]=y=>r.key=y),placeholder:"Storage Key"},null,8,["modelValue"])]),_:1}),s(m,{label:"Storage value",required:"",prop:"value"},{default:c(()=>[s(f,{modelValue:r.value,"onUpdate:modelValue":o[1]||(o[1]=y=>r.value=y),placeholder:"Storage value"},null,8,["modelValue"])]),_:1}),s(m,{label:"Storage expire",prop:"expire"},{default:c(()=>[s(V,{modelValue:r.expire,"onUpdate:modelValue":o[2]||(o[2]=y=>r.expire=y),placeholder:"Storage expire"},{default:c(()=>[s(w,{label:"1\u79D2",value:"1"}),s(w,{label:"1\u5206\u949F",value:"60"}),s(w,{label:"1\u5C0F\u65F6",value:"3600"})]),_:1},8,["modelValue"])]),_:1}),s(m,null,{default:c(()=>[s(S,{type:"primary",onClick:o[3]||(o[3]=y=>d(i.value))},{default:c(()=>[E("Setting Storage")]),_:1}),s(S,{type:"warning",onClick:x},{default:c(()=>[E("clear Select Storage")]),_:1}),s(S,{type:"danger",onClick:a},{default:c(()=>[E("clear All Storage")]),_:1})]),_:1})]),_:1},8,["model","rules"]),s(T,{"header-cell-style":{textAlign:"center"},"cell-style":{textAlign:"center"},data:J(A),border:"",onSelectionChange:_,style:{width:"100%"}},{default:c(()=>[s(C,{type:"selection",width:"55"}),s(C,{prop:"key",label:"Storage Key"}),s(C,{prop:"value",label:"Storage Value"}),s(C,{prop:"expire",label:"Expire time"}),s(C,{fixed:"right",label:"Operations"},{default:c(y=>[s(S,{type:"danger",size:"small",onClick:H=>l(y.row)},{default:c(()=>[E("remove")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])])}}});const z=I("",3),M=I("",4),X=JSON.parse('{"title":"useLocaleStorage","description":"","frontmatter":{},"headers":[],"relativePath":"hook/useStorage/index.md"}'),G={name:"hook/useStorage/index.md"},Y=Object.assign(G,{setup(n){return(i,t)=>{const D=F("ClientOnly");return q(),R("div",null,[z,L("div",null,[s(D,null,{default:c(()=>[s(j)]),_:1})]),M])}}});export{X as __pageData,Y as default};
