import{_ as N,o as A,a as m,b as n,d as L,G as X,c as k,u as _,z as S,E as Z,g as j,v,i as E,e as ss,n as P,r as b,m as ns,q as z,l as H,F as as,f as ls,D as ps,H as es,I as os,j as D,t as $,s as R,k as ts}from"./app.3985b09d.js";import{_ as rs}from"./chunks/index.vue_vue_type_script_setup_true_lang.5ff0222f.js";const cs={data:{type:Array,required:!0},keyField:{type:String,default:"key"},childrenField:{type:String,default:"children"},labelField:{type:String,default:"label"},defaultExpandKeys:{type:Array,default:()=>[]},selectKeys:{type:Array,default:()=>[]},selectable:Boolean,multiple:Boolean,checkable:Boolean,cascade:Boolean,defaultCheckedKeys:{type:Array,default:()=>[]},onLoad:Function},ys={"update:selectKeys":e=>e,"update:checkedKeys":(e,a)=>({node:e,val:a})},U=Symbol(),Fs={node:{type:Object,required:!0}},Ds={},is={t:"1677226511119",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3075",width:"16",height:"16"},Cs=n("path",{d:"M591.616 580.266667l-455.082667 341.333333A85.333333 85.333333 0 0 1 0 853.333333V170.666667a85.333333 85.333333 0 0 1 136.533333-68.266667l455.082667 341.333333a85.333333 85.333333 0 0 1 0 136.533334z","p-id":"3076"},null,-1),As=[Cs];function us(e,a){return A(),m("svg",is,As)}const ds=N(Ds,[["render",us]]),bs={},ms={t:"1677466103358",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2367",width:"16",height:"16"},hs=n("path",{d:"M509.8 305.01c-20.53 0-37.24-16.71-37.24-37.24V124.24c0-20.53 16.71-37.24 37.24-37.24 20.54 0 37.25 16.71 37.25 37.24v143.53c0 20.53-16.71 37.24-37.25 37.24z",fill:"#D2D7D4","p-id":"2368"},null,-1),fs=n("path",{d:"M387.95 338.82c-12.89 0-25.4-6.69-32.28-18.62l-71.72-124.24c-10.31-17.86-4.2-40.59 13.66-50.9 17.86-10.31 40.59-4.2 50.9 13.65l71.72 124.24c10.31 17.86 4.2 40.59-13.65 50.9-5.93 3.35-12.33 4.97-18.63 4.97z",fill:"#D4D8D6","p-id":"2369"},null,-1),gs=n("path",{d:"M299.23 429.06c-6.3 0-12.7-1.62-18.62-4.97l-124.24-71.72c-17.86-10.31-23.87-33.04-13.66-50.9 10.31-17.86 33.04-23.87 50.9-13.66l124.24 71.72c17.85 10.31 23.87 33.04 13.65 50.9-6.86 11.95-19.37 18.63-32.27 18.63z",fill:"#E3E3E3","p-id":"2370"},null,-1),qs=n("path",{d:"M267.72 551.49H124.19c-20.53 0-37.24-16.71-37.24-37.24 0-20.54 16.71-37.25 37.24-37.25h143.53c20.53 0 37.24 16.71 37.24 37.25 0 20.53-16.71 37.24-37.24 37.24z",fill:"#EEEEEE","p-id":"2371"},null,-1),Es=n("path",{d:"M177.28 745.06c-12.89 0-25.4-6.69-32.28-18.62-10.31-17.86-4.2-40.59 13.65-50.9l124.24-71.72c17.86-10.31 40.59-4.2 50.9 13.65 10.31 17.86 4.2 40.59-13.66 50.9L195.91 740.1c-5.92 3.34-12.32 4.96-18.63 4.96z",fill:"#FDFDFD","p-id":"2372"},null,-1),Bs=n("path",{d:"M319.96 886.2c-6.3 0-12.7-1.62-18.62-4.97-17.86-10.31-23.87-33.04-13.66-50.9l71.72-124.24c10.31-17.86 33.05-23.87 50.9-13.66 17.86 10.31 23.87 33.04 13.66 50.9l-71.72 124.24c-6.88 11.95-19.39 18.63-32.28 18.63z",fill:"#929697","p-id":"2373"},null,-1),_s=n("path",{d:"M514.2 937.01c-20.54 0-37.25-16.71-37.25-37.24V756.33c0-20.53 16.71-37.24 37.25-37.24 20.53 0 37.24 16.71 37.24 37.24v143.53c0 20.53-16.71 37.15-37.24 37.15z",fill:"#798286","p-id":"2374"},null,-1),ks=n("path",{d:"M707.77 884.01c-12.89 0-25.4-6.69-32.28-18.62l-71.72-124.24c-10.31-17.86-4.2-40.59 13.65-50.9 17.86-10.31 40.59-4.2 50.9 13.66l71.72 124.24c10.31 17.86 4.2 40.59-13.66 50.9a37.595 37.595 0 0 1-18.61 4.96z",fill:"#8D969F","p-id":"2375"},null,-1),vs=n("path",{d:"M848.81 741.24c-6.3 0-12.7-1.62-18.62-4.96l-124.24-71.72c-17.85-10.31-23.87-33.04-13.65-50.9 10.31-17.86 33.04-23.87 50.9-13.65l124.24 71.72c17.86 10.31 23.87 33.04 13.66 50.9-6.88 11.93-19.39 18.61-32.29 18.61z",fill:"#99A0A5","p-id":"2376"},null,-1),xs=n("path",{d:"M899.72 547.1H756.28c-20.53 0-37.24-16.71-37.24-37.25 0-20.53 16.71-37.24 37.24-37.24h143.53c20.53 0 37.24 16.71 37.24 37.24 0.01 20.54-16.71 37.25-37.33 37.25z",fill:"#A8AAAD","p-id":"2377"},null,-1),Ks=n("path",{d:"M722.47 425.24c-12.89 0-25.4-6.68-32.28-18.62-10.31-17.86-4.2-40.59 13.66-50.9L828.09 284c17.86-10.31 40.59-4.2 50.9 13.66 10.31 17.86 4.2 40.59-13.66 50.9L741.1 420.28c-5.93 3.34-12.32 4.96-18.63 4.96z",fill:"#BBBDC1","p-id":"2378"},null,-1),Ts=n("path",{d:"M632.13 336.62c-6.3 0-12.7-1.62-18.62-4.97-17.86-10.31-23.87-33.04-13.66-50.9l71.72-124.24c10.31-17.85 33.04-23.87 50.89-13.65 17.86 10.31 23.87 33.04 13.66 50.9L664.41 318c-6.87 11.94-19.38 18.62-32.28 18.62z",fill:"#C9CDCB","p-id":"2379"},null,-1),Ns=[hs,fs,gs,qs,Es,Bs,_s,ks,vs,xs,Ks,Ts];function Ls(e,a){return A(),m("svg",ms,Ns)}const ws=N(bs,[["render",Ls]]),Os=L({name:"treeNodeContent",props:Fs,setup(e){const a=X(U),o=e.node;return()=>a.slots.default?a.slots.default({node:o}):o==null?void 0:o.label}}),Ss=L({__name:"treeNode",props:{node:{type:Object,required:!0},isExpanded:{type:Boolean},loadingKeys:{type:Object,required:!0},selectKeys:{type:Object},defaultCheckedKeys:{type:Object,required:!0},checkable:Boolean,cascade:Boolean,checked:Boolean,indeterminate:Boolean},emits:{toggle:e=>e,select:e=>e,check:(e,a)=>!0},setup(e,{emit:a}){const o=e,u=y=>{a("check",o.node,y)},c=k(()=>{var y;return(y=o.selectKeys)==null?void 0:y.includes(o.node.key)}),q=y=>{a("select",y)},h=y=>{a("toggle",y)},f=k(()=>o.loadingKeys.has(o.node.key));return(y,l)=>(A(),m("div",{class:"container pointer",onClick:l[1]||(l[1]=i=>q(e.node)),style:P({paddingLeft:`${e.node.level*16}px`})},[n("span",{onClick:l[0]||(l[0]=Z(i=>h(e.node),["stop"])),class:j([{expanded:e.isExpanded&&!e.node.isLeaf}]),style:{"font-size":"12px"}},[_(f)?(A(),S(ws,{key:0})):(A(),S(ds,{key:1}))],2),(A(),m("div",{key:e.node.key,class:j({isSelected:_(c),node:!0})},[e.checkable?(A(),S(rs,{key:0,indeterminate:e.indeterminate,modelValue:e.checked,"onUpdate:modelValue":u},{default:v(()=>[E(_(Os),{node:e.node},null,8,["node"])]),_:1},8,["indeterminate","modelValue"])):ss("",!0)],2))],4))}});const $s=N(Ss,[["__scopeId","data-v-e3888cf1"]]),zs=L({__name:"virtualList",props:{size:{type:Number,default:0},remain:{type:Number,default:8},items:{type:Array,default:()=>[]}},setup(e){const a=e,o=b(),u=b();let c=ns({start:0,end:a.remain,offset:0});const q=k(()=>Math.min(c.start,a.remain)),h=k(()=>Math.min(a.items.length-c.end,a.remain));let f=k(()=>{const l=c.start-q.value,i=c.end+h.value;return a.items.slice(l,i)});function y(){c.start=Math.floor(o.value.scrollTop/a.size),c.end=c.start+a.remain,c.offset=c.start*a.size-q.value*a.size}return z(()=>a.items,()=>{}),H(()=>{o.value.style.height=a.remain*a.size+"px"}),(l,i)=>(A(),m("div",null,[n("div",{class:"wrapper",ref_key:"wrapper",ref:o,onScroll:y},[n("div",{class:"scrollBar",ref_key:"scrollBar",ref:u},null,512),n("div",{style:P({transform:`translateY(${_(c).offset}px)`})},[(A(!0),m(as,null,ls(_(f),(g,x)=>(A(),m("div",{key:x},[ps(l.$slots,"default",{node:g},void 0,!0)]))),128))],4)],544)]))}});const Ms=N(zs,[["__scopeId","data-v-0d7a93d4"]]),Vs=L({__name:"tree",props:cs,emits:ys,setup(e,{emit:a}){const o=e,u=b([]);let c={getChildren(s){return s[o.childrenField]},getKey(s){return s[o.keyField]},getLabel(s){return s[o.labelField]}};const q=function(s){return B.value.has(s.key)};function h(s,p){function t(r,C=null){return r.map(d=>{const I=c.getChildren(d||[]),O={key:c.getKey(d),label:c.getLabel(d),children:[],rowNode:d,isLeaf:d.isLeaf??I.length,level:C?C.level+1:0,parentKey:C==null?void 0:C.key};return I.length>0&&(O.children=t(d.children,O)),O})}return t(s,p)}z(()=>o.data,s=>{u.value=h(s)},{immediate:!0}),es(U,{slots:os()});const f=b([]),y=b(new Set);function l(s){return y.value.has(s.key)}function i(s,p){let t=B.value;if(!s)return t;p&&y.value.delete(s.key),t[p?"add":"delete"](s.key);let F=s.children;return F?(F.forEach(r=>{i(r,p)}),t):[]}function g(s){let p=!0,t=!0,F=s.parentKey;if(F){let r=K(F);for(let C of r.children)B.value.has(C.key)?t=!0:y.value.has(C.key)?(p=!1,t=!0):p=!1;p?(B.value.add(r.key),y.value.delete(r.key)):t&&(B.value.delete(r.key),y.value.add(r.key)),g(r)}}function x(s,p){const t=i(s,p);g(s),a("update:checkedKeys",p,Array.from(t))}function K(s){let p={};function t(F){for(let r=0;r<F.length;r++){const C=F[r];if(!C)return;if(C.key===s)return p=C,p;C.children&&t(C.children)}}return t(V.value),p}H(()=>{B.value.forEach(s=>{i(K(s),!0)})});function M(s){let p=Array.from(f.value);if(o.selectable){if(o.multiple){let t=p.findIndex(F=>F==s.key);t>-1?p.splice(t,1):p.push(s.key)}else p.includes(s.key)?p=[]:p=[s.key];a("update:selectKeys",p)}}z(()=>o.selectKeys,s=>{f.value=s},{immediate:!0});const B=b(new Set(o.defaultCheckedKeys)),T=b(new Set(o.defaultExpandKeys)),J=function(s){return T.value.has(s.key)};function G(s){T.value.delete(s.key)}const w=b(new Set);function Y(s){if(!s.isLeaf){const p=w.value;if(!p.has(s.key)){p.add(s.key);const t=o.onLoad;t&&t(s.rowNode).then(F=>{s.rowNode.children=F,s.children=h(F,s),p.delete(s.key)})}}}function Q(s){T.value.add(s.key),o.onLoad&&Y(s)}function W(s){T.value.has(s.key)&&!w.value.has(s.key)?G(s):Q(s)}const V=k(()=>{let s=T.value,p=[],t=u.value||[],F=[];for(let r=t.length-1;r>=0;r--)F.push(t[r]);for(;F.length;){let r=F.pop();if(r&&(p.push(r),s.has(r.key))){const C=r.children;for(let d=C.length-1;d>=0;d--)F.push(C[d])}}return p});return(s,p)=>(A(),m("div",null,[E(Ms,{remain:8,size:40,items:_(V)},{default:v(({node:t})=>[E($s,{node:t,indeterminate:l(t),checkable:s.checkable,checked:q(t),defaultCheckedKeys:B.value,isExpanded:J(t),loadingKeys:w.value,selectKeys:f.value,onToggle:W,onCheck:x,onSelect:M},null,8,["node","indeterminate","checkable","checked","defaultCheckedKeys","isExpanded","loadingKeys","selectKeys"])]),_:1},8,["items"])]))}}),Is={class:"container"},js={class:"msg"},Rs={class:"data"},Ps={class:"msg"},Hs={class:"data"},Us=L({__name:"index",setup(e){const a=b(["40"]),o=(l,i)=>{a.value=i},u=b(["40"]);function c(l){return new Promise(i=>{setTimeout(()=>{i([{key:l.key+y(l.label)+Math.random(),label:y(),children:[],isLeaf:!1}])},1e3)})}const q=h();function h(l=4,i=""){return l?Array.from({length:l},(g,x)=>{const K=""+i+l+x;return{label:f(l),key:K,children:h(l-1,K)}}):[]}function f(l){return l===4?"道生一":l===3?"一生二":l===2?"二生三":l===1?"三生万物":""}function y(l){return l?l==="道生一"?"一生二":l==="一生二"?"二生三":l==="二生三"?"三生万物":l==="三生万物"?"Out of Tao, One is born":"":"虚拟道生一"}return(l,i)=>(A(),m("div",Is,[n("p",js,[D("选中的item: "),n("span",Rs,$(u.value),1)]),n("p",Ps,[D("选中的checkbox:"),n("span",Hs,$(a.value),1)]),E(Vs,{data:_(q),selectKeys:u.value,"onUpdate:selectKeys":i[0]||(i[0]=g=>u.value=g),selectable:"",multiple:"",checkable:"","default-checked-keys":a.value,"on-load":c,"onUpdate:checkedKeys":o},{default:v(({node:g})=>[D($(g.label),1)]),_:1},8,["data","selectKeys","default-checked-keys"])]))}});const Js=N(Us,[["__scopeId","data-v-9acd7968"]]),Gs=n("h1",{id:"树形组件",tabindex:"-1"},[D("树形组件 "),n("a",{class:"header-anchor",href:"#树形组件","aria-hidden":"true"},"#")],-1),Ys=n("p",null,[D("思路/数据来源 ["),n("a",{href:"https://www.naiveui.com/zh-CN/os-theme/components/tree",target:"_blank",rel:"noreferrer"},"https://www.naiveui.com/zh-CN/os-theme/components/tree"),D("]")],-1),Qs=n("code",null,"flattenTree",-1),Ws=n("li",null,[D("遍历"),n("code",null,"flattenTree"),D(",把遍历后的数据"),n("code",null,"node"),D(" 传递给下一层级，作用域插槽")],-1),Xs=n("li",null,"虚拟滚动 / 懒加载等 其余次要逻辑 都是基于此",-1),Zs=n("h1",{id:"基础用法",tabindex:"-1"},[D("基础用法 "),n("a",{class:"header-anchor",href:"#基础用法","aria-hidden":"true"},"#")],-1),sn=ts("",6),pn=JSON.parse('{"title":"树形组件","description":"","frontmatter":{},"headers":[{"level":2,"title":"1. 形成一个通用的数据结构","slug":"_1-形成一个通用的数据结构","link":"#_1-形成一个通用的数据结构","children":[]},{"level":2,"title":"2. 扁平化数据结构","slug":"_2-扁平化数据结构","link":"#_2-扁平化数据结构","children":[]},{"level":2,"title":"层级问题","slug":"层级问题","link":"#层级问题","children":[]},{"level":2,"title":"一些 ts 类型","slug":"一些-ts-类型","link":"#一些-ts-类型","children":[]}],"relativePath":"examples/tree/index.md"}'),nn={name:"examples/tree/index.md"},en=Object.assign(nn,{setup(e){return(a,o)=>{const u=R("green"),c=R("red");return A(),m("div",null,[Gs,Ys,n("ol",null,[n("li",null,[D("由于可以自定义"),E(u,null,{default:v(()=>[D("lable / key")]),_:1}),D("值，所以第一步需要函数"),E(c,null,{default:v(()=>[D("createTree")]),_:1}),D("格式化代码")]),n("li",null,[D("格式化后的代码增加属性"),E(c,null,{default:v(()=>[D("level,表明层级")]),_:1}),D("，通过计算属性"),Qs,D("获得一个拍平后的数据")]),Ws,Xs]),Zs,E(Js),sn])}}});export{pn as __pageData,en as default};
